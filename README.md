1. [Настройка CLI YandexSpeechKit](#a)
2. [Диалог](#b) 
3. [Установка](#c)

Butler – это виртуальный дворецкий, который открывает дверь гостю, если имя есть в списке приглашенных.
Для распознавания ответа гостя и синтеза речи дворецкого используются технологии [Yandex SpeechKit](https://cloud.yandex.ru/docs/speechkit/) (YSK). 

# Настройка CLI YandexSpeechKit <a name="a"></a>

Батлер будет работать, если вы уже установили CLI для работы с YSK и получили токены для отправки запросов.
Подробно об этом – в [туториале](https://github.com/ladykot/Butler/blob/master/YSK_Tutorial.md#%D1%83%D1%87%D0%B8%D0%BC%D1%81%D1%8F-%D0%B8%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D1%8C-api-%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0-yandex-speechkit).


# Диалог <a name="b"></a>

Прежде чем писать код, давайте представим, как будет выглядеть диалог Батлера с гостем. Возможно, как-то так:

    # <стук в дверь>
    B: “Привет, чувак! Назови мне только свои имя и фамилию”
    G: <Имя>
    Если имя в списке:
        “Рад тебя видеть, <имя>, заходь!”
        <дверь открыватеся>
    Если имя не в списке:
        “Рад тебя видеть, <имя>, но тебя нет в списке, сорян!”
    Если ответ не распознан как текст:
        # чтобы эту ситуацию не учитывать и не перегружать код исключениями, 
        я взяла успешный случай. Гость точно назовет себя, а Батлер – распознает 
        ответ. Будет здорово, если вы сами это сделаете для тренировки.

Для визуализации диалога и прослушивания можно использовать фреймворк для голосовых ассистентов [Tortu](https://tortu.io/prototype/9d1493).
Удобно и легко, если диалог имеет множество ветвей.

Создайте готовый аудио-файл с ответом гостя. Сделать это можно через встроенный 
микрофон на вашем ноутбуке разными инструментами. Для macos подойдет Quick Time Player. 
Сконвертируйте аудио в формат ogg: name_guest.ogg. Можно онлайн, например, [тут](https://online-audio-converter.com/ru/).

Звуковые файлы bell_door и open_door добавят коду реалистичности происходящего :).

Установим необходимые зависимости:

    $ pip install -r requirements.txt

Создадим файл config.py и зададим id_folder и oauth_token:

    config.py
    
    import os
 
    
    def env_set():
        """ Функция задает переменные окружения,
        чтобы использовать их в запросах к API YSK:
        oauth_token (str)
        id_folder (str)
    
        :return: True
        """
        os.environ["oauth_token"] = "AgAAAAAAH..."
        os.environ["id_folder"] = "b1gdt133..."
        return True
        
Для записи и чтения iam-токена используется файл iam.txt. При каждом запросе
токен будет проверяться на работоспособность и генерироваться, если срок его жизни истек.





